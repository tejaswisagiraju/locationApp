


<style>


  #map {
    height: 550px;
    border: dashed;
    border-color: #7f8c8d;
  }

  #heading-text {
  
    padding-bottom: 25px;
    text-align: center;
  }

</style>


<% if current_user %>


<div class="page-header">
      <h2><small>Listing Places</small></h2>
      <table class="reference" style="width:30%">
          
          <tr>

            <th>Title</th>
            <th>Address</th>
            <th>Description</th>

          </tr>

      <% @user.locations.each do |location| %>
          
          <tr>
   
            <td><%= location.address %></td>
            <td><%= location.description %></td>
            <td><%= location.name %></td>
            <td><%= link_to 'Show', "/users/:user_id/locations/:id" %></td>
            <td><%= link_to 'Edit', "/users/:user_id/locations/:id/edit" %></td>
            <td><%= link_to 'Destroy', "/users/:user_id/locations/:id", method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
    
      <% end %>
    </table>

<br>

  <%= link_to 'New Location', user_location_new_path %>
</div>
    
<body>

  <div id="map"></div>

</body>




<% else %>

  <body>
    <div class="container" id="heading-text">

      <h1><small>See where people are traveling</small></h1>
    </div>
  </br>
    <div class="container" id="map"></div>
  </body>
      
<% end %>




<script type="text/javascript">

// $(document).on("page:change", initMap)

// function initMap(){

  var mapOptions = 
  {
      maxZoom:6,
      minZoom:2,

  };

   

  handler = Gmaps.build('Google', {markers: { maxRandomDistance: null} });
  handler.buildMap({ provider: mapOptions, internal: {id: 'map'}}, function(){
    if(navigator.geolocation)
      navigator.geolocation.getCurrentPosition(displayOnMap);
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    handler.bounds.extendWith(markers);

    handler.fitMapToBounds();

  });

  function displayOnMap(position){
  var marker = handler.addMarker({
    lat: position.coords.latitude,
    lng: position.coords.longitude,
  });
  handler.map.centerOn(marker);
};
// }

</script>



















